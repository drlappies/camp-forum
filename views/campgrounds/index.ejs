<% layout('layouts/boilerplate') %>
    <div class="container">
        <div id="cluster-map" class="mb-3 d-none d-lg-block"></div>
        <form class="row g-3 mb-3">
            <div class="col-lg-8">
                <div class="input-group">
                    <span class="input-group-text">
                        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor"
                            class="bi bi-search" viewBox="0 0 16 16">
                            <path
                                d="M11.742 10.344a6.5 6.5 0 1 0-1.397 1.398h-.001c.03.04.062.078.098.115l3.85 3.85a1 1 0 0 0 1.415-1.414l-3.85-3.85a1.007 1.007 0 0 0-.115-.1zM12 6.5a5.5 5.5 0 1 1-11 0 5.5 5.5 0 0 1 11 0z" />
                        </svg>
                    </span>
                    <input class="form-control" type="text" name="query">
                </div>
            </div>
            <div class="col-lg-3">
                <select class="form-select" name="sortby">
                    <option value="nosort" selected>Sort By:</option>
                    <option value="latest">Latest</option>
                    <option value="earliest">Earliest</option>
                    <option value="highestrated">Highest rated</option>
                    <option value="lowestrated">Lowest rated</option>
                    <option value="highestpriced">Highest priced</option>
                    <option value="lowestpriced">Lowest priced</option>
                    <option value="mostreviewed">Most reviewed</option>
                </select>
            </div>
            <div class="col-lg-1 d-grid">
                <button class="btn btn-secondary" type="submit">Search</button>
            </div>
        </form>
        <div class="d-flex flex-wrap justify-content-start">
        <% for (let camp of campground){ %>
            <div class="card my-2 mx-2" style="width: 300px;">
                <img class="img-fluid" alt="" src="<%= camp.image[0].url %>">
                <div class="card-body">
                    <h5 class="card-title">
                        <%= camp.title %>
                    </h5>
                    <p class="card-text">
                        <%= camp.description.substring(0, 100).concat(' '+' ...')%>
                    </p>
                    <p class="card-text">
                        <small class="text-muted">
                            <%= camp.location%>
                        </small>
                    </p>
                    <a class="btn btn-secondary float-end" href="/campgrounds/<%= camp._id %>">Read more
                    </a>
                </div>
            </div>
            <% } %>
        </div>
    </div>
    <script>
        const mapToken = '<%-process.env.MAPBOX_TOKEN %>'
        const campground = { features: <%-JSON.stringify(campground) %> }
    </script>
    <script src="/js/clusterMap.js"></script>